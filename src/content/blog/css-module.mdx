---
title: css-modules ä½¿ç”¨è¯´æ˜
pubDate: 2023-03-18
intro: å­¦ä¹ å¦‚ä½•è§£å†³ä¼ ç»Ÿcsså‘½åå†²çª,ä½œç”¨åŸŸæ±¡æŸ“å’Œæ ·å¼ç»´æŠ¤å›°éš¾çš„é—®é¢˜, ä»¥åŠå¦‚ä½•é…ç½®css-modules
tag: css
author: lbsong
image: ../../assets/css-modules/css-modules-logo.jpg
tableContents: [
  {
    id: '#css-modules',
    name: 'css-modules',
    children: [
      {
        id: '#1-åŸºç¡€ä½¿ç”¨',
        name: 'åŸºç¡€ä½¿ç”¨'
      },
      {
        id: '#2-ç»„åˆç±»å',
        name: 'ç»„åˆç±»å'
      },
      {
        id: '#3-æ˜¾æ€§ä¾èµ–',
        name: 'æ˜¾æ€§ä¾èµ–'
      },
      {
        id: '#4-ä½¿ç”¨å˜é‡',
        name: 'ä½¿ç”¨å˜é‡'
      },
      {
        id: '#5-é…ç½®css-moduleswebpack',
        name: 'é…ç½®css-modules'
      }
    ]
  },
  {
    id: '#æ€»ç»“',
    name: 'æ€»ç»“'
  }
]
readTime: '5'
---

import { Image } from 'astro:assets'
import productComplie from '../../assets/css-modules/productComplie.png'

css-modules è§£å†³äº†ä¼ ç»Ÿ CSS ä¸­å‘½åå†²çªã€ä½œç”¨åŸŸæ±¡æŸ“å’Œæ ·å¼ç»´æŠ¤å›°éš¾çš„é—®é¢˜ï¼Œæä¾›äº†æ›´å¥½çš„æ ·å¼æ¨¡å—åŒ–å’Œç»„ç»‡æ–¹å¼ï¼Œä½¿å¾—å‰ç«¯å¼€å‘æ›´åŠ æ˜“äºç®¡ç†å’Œæ‰©å±•ã€‚ä»¥ä¸‹ä½ å°†è¯¦ç»†äº†è§£
css-modules çš„ä¼˜ç‚¹å’Œè§£å†³çš„é—®é¢˜, ä»¥åŠå¦‚ä½•é…ç½®css-modules

## å…¨å±€ä½œç”¨åŸŸæ ·å¼æ±¡æŸ“

```javascript
const Header1 = () => {
  return <div className="header-container">header</div>
};

const Header2 = () => {
  return <div className="header-container">header</div>
};
```


ä»¥ä¸Šæœ‰ä¸¤ä¸ªç»„ä»¶ä½¿ç”¨äº†ä¸€æ ·çš„æ ·å¼å, é‚£ä¹ˆåœ¨åŒä¸€ä¸ªé¡µé¢æ¸²æŸ“åå°±ä¼šå‡ºç°æ ·å¼å†²çª, åœ¨ä½œè€…å·¥ä½œçš„é¡¹ç›®ä¸­ç”±äºä½¿ç”¨åˆ°äº†å¾®å‰ç«¯çš„æ¶æ„, 
è¯¥é—®é¢˜åœ¨åŒä¸€ä¸ªé¡µé¢ä¸­è‹¥ç”¨åˆ°ä¸åŒé¡¹ç›®ä¸­çš„ç»„ä»¶æ ·å¼æ±¡æŸ“çš„é—®é¢˜ä¼šå°¤ä¸ºçªå‡º

é’ˆå¯¹è¯¥é—®é¢˜ä¼ ç»Ÿçš„è§£å†³æ–¹æ¡ˆæ˜¯åœ¨å›¢é˜Ÿä½¿ç”¨ [BEM](https://getbem.com) ç­‰cssæ–¹æ³•è®º, ä½†ç”±äºæ­¤ç±»æ–¹æ¡ˆéœ€è¦çº¦æŸå¼€å‘äººå‘˜ç¼–ç è§„èŒƒ,
éœ€è¦ä¸€å®šç¨‹åº¦çš„å£å¤´ç¼–ç è§„èŒƒ, å®æ–½èµ·æ¥é˜»ç¢åå¤§, å¹¶ä¸å®Œå…¨é€‚åˆçœŸå®çš„ä¸šåŠ¡åœºæ™¯ã€‚è€Œcss-modulesçš„è®¾è®¡å®Œç¾å¯ä»¥è§£å†³è¿™ä¸ªé—®é¢˜

## æ ·å¼åå–åå›°éš¾, æ ·å¼ååµŒå¥—å±‚çº§è¿‡æ·±

```javascript
// ä¸€ä¸ªç»„ä»¶çš„domç»“æ„å¯èƒ½æ˜¯è¿™æ ·çš„
const Test = () => {
  return (
    <div className="test-conainer">
      <div className="test-conainer-header">
        <div className="test-left"></div>
        <div className="test-rigjt"></div>
      </div>
    </div>
  )
}
```

## css-modules

æ ¹æ®å®˜æ–¹æ–‡æ¡£, css moduleså¤„ç†è¿‡çš„ç±»å  éƒ½åœ¨æœ¬åœ°ä½œç”¨åŸŸä¸‹, css modulesæ—¨åœ¨è§£å†³cssçš„å…¨å±€èŒƒå›´æ±¡æŸ“é—®é¢˜, css modulesæœ‰å‡ ä¸ªä¼˜ç‚¹

1. æ¯ä¸ªcssæ–‡ä»¶åªé€‚ç”¨äºè¢«å¼•ç”¨çš„é‚£ä¸ªç»„ä»¶, ä¸ä¼šå½±å“åˆ°å…¨å±€èŒƒå›´å†…çš„å…¶ä»–ç»„ä»¶ (no more global scope)
2. ä¸€ä¸ªç»„ä»¶çš„æ ·å¼å®Œå…¨æ¥æºäºä¸€ä¸ªcssæ–‡ä»¶(å…¨å±€è¦†ç›–æ ·å¼é™¤å¤–) (æ²¡æœ‰å†²çª)
3. æ˜¾æ€§ä¾èµ–

#### 1. åŸºç¡€ä½¿ç”¨

```javascript
import styles from './test.module.css';
const Test = () => {
  return (
    <div className={styles.container}>
      <div className={styles.header} />
      <div className={styles.headerRight} />
    </div>	
  )
}
```

```css
/* test-module.css */
.container {}
.header {}
/* æ¨èä½¿ç”¨é©¼å³°å‘½å */
.headerRight {}
/* å¦‚æœæ²¡æœ‰æœ‰ä¸æƒ³è¢«ç¼–è¯‘çš„ç±»å é‚£ä¹ˆå¯ä»¥å†™æˆ å¦‚ä¸‹otherç±»åå°†ä¸ä¼šè¢«ç¼–è¯‘ å§‹ç»ˆå…·æœ‰å…¨å±€åŸŸæ•ˆæœ */
:global(.other) {}
```

ç¼–è¯‘åç»“æœ
<Image src={productComplie} style={{ textAlign: 'left', marginLeft: 0 }} alt="" />
å¦‚ä¸Šç¼–è¯‘åç±»åè¢«ç¼–è¯‘æˆhashæ ¼å¼ç¡®ä¿ç±»åå”¯ä¸€ ä»¥éš”ç»åç§°å†²çªçš„é—®é¢˜ğŸ˜, ç¼–è¯‘åç±»ååç§°å¯è‡ªå®šä¹‰, å»ºè®®ç”Ÿäº§ä½¿ç”¨[hash:64], å¼€å‘ç¯å¢ƒä½¿ç”¨æ–‡ä»¶è·¯å¾„

#### 2. ç»„åˆç±»å

```css
.flex {
  display: flex;
  justify-content: center;
  align-items: center;
}

.container {
  /* é¢å¤–æ ·å¼å¦‚ font-sizeç­‰ */
  /*
  ä½¿ç”¨composeså…³é”®å­—å¤ç”¨flexé€šç”¨ç±», ä¸ç”¨é¢å¤–å®šä¹‰ 
  åœ¨vscodeå¯èƒ½æŠ¥å…³é”®è¯error, éœ€è¦åœ¨é…ç½®æ–‡ä»¶åŠ ä¸Š"css.lint.validProperties": ["composes"]
   */
  composes: flex
}
```

#### 3. æ˜¾æ€§ä¾èµ–

```css
.flex {
  display: flex;
  justify-content: center;
  align-items: center;
}

.container {
  width: 100px;
  composes: flex;
  /** å…è®¸ç»„åˆå¤šä¸ª åŒæ—¶å…è®¸å¼•å…¥å…¶ä»–æ–‡ä»¶ä¸­çš„ç±»å, è¿™æ ·å¸®åŠ©æˆ‘ä»¬äº†è§£æ‰€æœ‰æ ·å¼ä¸­çš„å‡ºå¤„æ˜¾æ€§ä¾èµ– */
  composes: other from './other.module.css';
}
```

#### 4. ä½¿ç”¨å˜é‡

é¡¹ç›®ä¸­æˆ‘ä»¬å¯èƒ½æœ‰å¤šç§ä¸»é¢˜, æˆ‘ä»¬éœ€è¦ä¸€ä¸ªæ–‡ä»¶ç»Ÿä¸€ç®¡ç†è¿™äº›å¸¸é‡ é¢œè‰², é—´è·, å­—ä½“ç­‰
ä½¿ç”¨å‰æ [namedExport](https://webpack.docschina.org/loaders/css-loader/#namedexport) éœ€æ‰“å¼€
```css
/** config/variable.module.css */
/** æ¨èå¯¹ç‰¹å®šçš„å€¼ä½¿ç”¨ v- çš„å‰ç¼€ï¼Œç»™é€‰æ‹©å™¨ä½¿ç”¨ s- çš„å‰ç¼€ï¼Œå¹¶ä¸”ä¸ºåª’ä½“è§„åˆ™ä½¿ç”¨ m- å‰ç¼€ã€‚*/
@value v-blue: #0c77f8;
@value v-red: #ff0000;
@value v-green: #aaf200;
@value s-black: black-selector;
@value m-large: (min-width: 960px);

/** ä½¿ç”¨ 
test.module.css
*/

@value v-red, v-blue, s-black, m-large from 'config/variable.module.css';
.container {
  background: v-blue;
}

.s-black {
  backgroud: #000;
}

@media m-large {
  
}
```

#### 5. é…ç½®css-modules(webpack)

```javascript
module.exports = {
  module: {
    rules: [
      {
        test: /\.css$/,
        use: [
          {
            loader: 'css-loader',
            options: {
              modules: {
                /** autoä¸ºtrue, å°†è¯†åˆ«xxx.module.cssçš„æ ¼å¼ä¸ºcss modules,å¯¹xxx.cssä¸ä¼š
                  ç¼–è¯‘æˆcss modulesçš„æ ¼å¼
                */
                auto: true,
                // å¼€å‘ç¯å¢ƒä½¿ç”¨[path][name]__[local]æ–¹ä¾¿è°ƒè¯•, ç”Ÿæˆç¯å¢ƒç›´æ¥[hash64]è¾“å‡ºç±»å
                localIdentName: '[path][name]__[local]',
                /** å¼€å¯es6å¯¼å‡ºæ ¼å¼, å¼€å¯åå¯ä»¥ä½¿ç”¨css moduleså˜é‡åŠŸèƒ½,
              åŒæ—¶ç»„ä»¶ä¸­å¯¼å…¥æ ·å¼ å¯ä»¥ç›´æ¥ import { container } from 'index.module.css'
                */
                namedExport: true,
                // ä½¿ç”¨é©¼å³°æ ¼å¼
                exportLocalsConvention: 'camelCaseOnly'
              },
            }
          },
        ]
      },
    ]
  }
}
```

## æ€»ç»“

css-modulesä¼˜åŠ¿
1. æ¯ä¸ªcssæ–‡ä»¶åªé€‚ç”¨äºè¢«å¼•ç”¨çš„é‚£ä¸ªç»„ä»¶, ä¸ä¼šå½±å“åˆ°å…¨å±€èŒƒå›´å†…çš„å…¶ä»–ç»„ä»¶ (æ²¡æœ‰å…¨å±€ä½œç”¨åŸŸ, æ— æ ·å¼æ±¡æŸ“é—®é¢˜)
2. ä¸€ä¸ªç»„ä»¶çš„æ ·å¼å®Œå…¨æ¥æºäºä¸€ä¸ªcssæ–‡ä»¶(å…¨å±€è¦†ç›–æ ·å¼é™¤å¤–)
3. æ˜¾æ€§ä¾èµ– (å¸®åŠ©å¼€å‘äººå‘˜åœ¨ä»£ç ç»“æ„ä¸­æ›´å¥½äº†è§£åˆ°ç»„ä»¶çš„æ ·å¼ä¾èµ–)

ps. å¦‚æœä½ ä¸æƒ³å†™ç»†ç²’åº¦çš„æ ·å¼,å’Œé€šç”¨çš„æ ·å¼ æƒ³ç›´æ¥ä½¿ç”¨é¢„å®šä¹‰å¥½çš„cssç±»å, é‚£ä¹ˆæ¨èä½¿ç”¨ [tailwindcss](https://tailwindcss.com/)

## å‚è€ƒæ–‡ç« 
1. [https://glenmaddern.com/articles/css-modules](https://glenmaddern.com/articles/css-modules)
2. [https://github.com/css-modules/css-modules](https://github.com/css-modules/css-modules)